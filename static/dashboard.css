/* --- DASHBOARD-SPECIFIC STYLES --- */
/* These rules apply ONLY to the index.html (Dashboard) page. */


/* --- TOP LAYOUT & QUALITY EXPLANATION --- */
/* Styles for the main layout grid of the dashboard. */

/* Flex container for the top section (explanation card and charts).
   Applied to: <div class="top-layout"> */
.top-layout {
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: flex-start;
    gap: 30px;
    flex-wrap: wrap;
    margin-bottom: 10px;
}

/* The main card on the left that shows detailed text analysis from the AI.
   Applied to: <div class="quality-explanation"> */
.quality-explanation {
    background-color: #ffffff;
    border: 1px solid #e0e0e0;
    border-radius: 20px;
    padding: 25px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    text-align: left;
    overflow-y: auto; /* Enables scrolling if content is too long. */
    width: 900px;
    min-height: 630px;
    max-height: 640px;
    scrollbar-width: thin; /* For Firefox */
    scrollbar-color: #ccc #f1f1f1; /* For Firefox */
}

/* Main title inside the explanation card.
   Applied to: <h2> */
.quality-explanation h2 {
    color: #2c3e50;
    margin-top: 0;
    margin-bottom: 15px;
    text-align: center;
    font-size: 1.8em;
    font-weight: 600;
    border-bottom: 1px solid #ddd;
    padding-bottom: 10px;
}

/* Sub-title inside the explanation card.
   Applied to: <h3> */
.quality-explanation h3 {
    color: #2c3e50;
    margin-top: 0;
    margin-bottom: 15px;
    text-align: center;
    font-size: 1.5em;
    font-style: italic;
}

/* Paragraphs inside the explanation card.
   Applied to: <p> */
.quality-explanation p {
    font-size: 1.5em;
    line-height: 1.6;
    margin-bottom: 10px;
    color: #555;
}

/* Custom scrollbar for WebKit browsers (Chrome, Safari). */
.quality-explanation::-webkit-scrollbar {
    width: 6px;
}
.quality-explanation::-webkit-scrollbar-track {
    background: transparent;
    border-radius: 8px;
}
.quality-explanation::-webkit-scrollbar-thumb {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 8px;
}
.quality-explanation::-webkit-scrollbar-thumb:hover {
    background: rgba(0, 0, 0, 0.4);
}


/* --- ANALYSIS ICONS --- */
.analysis-icons-container {
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    gap: 20px;
    justify-content: center;
    align-items: flex-start;
}

.icon-section {
    text-align: center;
    color: #333;
}

.icon-section h3 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 1.1em;
    font-weight: 600;
    color: #555;
}

.status-icon p {
    font-weight: bold;
    font-size: 1.2em;
    margin: 5px 0 0 0;
}

.usage-icons-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    justify-content: center;
}

.usage-icon {
    text-align: center;
}

.usage-icon p {
    font-size: 0.8em;
    color: #666;
    margin: 2px 0 0 0;
}


/* --- LINE CHARTS --- */
/* Styles for the four small line charts on the dashboard. */

/* Grid container for the four line charts.
   Applied to: <div id="chartsContainer"> */
#chartsContainer {
    display: grid !important;
    grid-template-columns: repeat(2, 1fr); /* Creates a 2x2 grid. */
    gap: 0px;
    margin-top: -10px;
    max-width: 950px;
}

/* Individual chart canvas styling.
   Applied to: <canvas> elements inside #chartsContainer. */
#chartsContainer canvas {
    background-color: #ffffff;
    border: 1px solid #e0e0e0;
    border-radius: 12px;
    padding: 15px;
    margin: 15px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    max-width: 450px;
    width: 100%;
    max-height: 300px;
    box-sizing: border-box;
}


/* --- GAUGE METRICS --- */
/* Styles for the gauge components at the bottom of the dashboard. */

/* Flex container for all the gauges.
   Applied to: <div class="gauge-container-wrapper"> */
.gauge-container-wrapper {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 20px;
    padding: 0px;
    border-radius: 8px;
    margin-bottom: 20px;
    z-index: 1000; 
}

/* Individual card for each gauge.
   Applied to: <div class="gauge-card"> */
.gauge-card {
    position: relative;
    background-color: #f0f0f0;
    border-radius: 40px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    padding: 15px;
    text-align: center;
    width: fit-content;
    min-width: 160px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    transition: transform 0.2s ease;
}

/* Subtle lift effect on hover for gauge cards. */
.gauge-card:hover {
    transform: translateY(-5px);
}

/* The SVG container for the gauge graphic.
   Applied to: <div class="gauge"> */
.gauge {
    width: 150px;
    height: 100px;
    position: relative;
    overflow: hidden;
    margin-bottom: 10px;
}

.gauge svg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

/* The gray background arc of the gauge. */
.gauge .gauge-arc-bg {
    fill: none;
    stroke: #e0e0e0;
    stroke-width: 15;
    stroke-linecap: round;
}

/* The colored progress arc of the gauge. */
.gauge .gauge-arc-progress {
    fill: none;
    stroke: #007bff; /* Default blue color. */
    stroke-width: 15;
    stroke-linecap: round;
    transition: stroke-dasharray 0.5s ease-out, stroke 0.5s ease-out;
}

/* The text value displayed inside the gauge. */
.gauge .gauge-value {
    font-size: 2.5em;
    font-weight: bold;
    fill: #333;
    text-anchor: middle;
    dominant-baseline: central;
}

/* The label below the gauge (e.g., "Temperature (Â°C)").
   Applied to: <div class="gauge-label"> */
.gauge-label {
    font-size: 0.9em;
    color: #666;
    margin-top: 5px;
}

/* The tooltip container */
.gauge-tooltip {
    visibility: hidden; /* Hidden by default */
    opacity: 0;
    width: 220px;
    background-color: #2c3e50; /* Dark background */
    color: #fff; /* White text */
    text-align: center;
    border-radius: 8px;
    padding: 10px;
    position: absolute;
    z-index: 100000;
    bottom: 110%; /* Position above the gauge card */
    left: 50%;
    margin-left: -110px; /* Use half of the width to center the tooltip */
    transition: opacity 0.3s ease; /* Smooth fade-in/out effect */
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

/* Tooltip arrow */
.gauge-tooltip::after {
    z-index: 100000;
    content: "";
    position: absolute;
    top: 100%; /* At the bottom of the tooltip */
    left: 50%;
    margin-left: -5px;
    border-width: 5px;
    border-style: solid;
    border-color: #2c3e50 transparent transparent transparent;
}

/* Paragraph styling inside the tooltip */
.gauge-tooltip p {
    margin: 5px 0;
    font-size: 0.9em;
    line-height: 1.4;
}

.gauge-tooltip p em {
    color: #bdc3c7; /* Lighter color for the English translation */
}

/* Show the tooltip on hover */
.gauge-card:hover .gauge-tooltip {
    visibility: visible;
    opacity: 1;
}

/* Dynamic colors for the gauge progress arc based on water quality. */
.gauge-arc-progress.good { stroke: #28a745; }
.gauge-arc-progress.average { stroke: #ffc107; }
.gauge-arc-progress.poor { stroke: #dc3545; }
.gauge-arc-progress.bad { stroke: #6c757d; }


/* --- WATER QUALITY CARD --- */
/* The main text card showing the overall quality status. */

/* The quality value text (e.g., "Good", "Poor").
   Applied to: <div id="water_quality"> */
#water_quality {
    font-size: 2.5em;
    font-weight: bold;
    margin-bottom: 5px;
    width: 10vw;
}

/* The "Water Quality" label text.
   Applied to: <div class="label"> */
.card .label {
    font-size: 1.2em;
    font-weight: 600;
}

/* dashboard.css */

/* --- ML Prediction Display Styles --- */
.confidence-label {
    display: flex;
    justify-content: space-between;
    width: 100%;
    font-size: 0.8em;
    font-weight: 600;
    color: #666;
    margin-bottom: 4px;
}

.progress-bar-container {
    width: 100%;
    height: 10px;
    background-color: #e0e0e0;
    border-radius: 5px;
    overflow: hidden;
}

.progress-bar-fill {
    height: 100%;
    width: 0%; /* Default width */
    border-radius: 5px;
    background-color: #3498db; /* Default color */
    transition: width 0.5s ease-out, background-color 0.5s ease-out;
}

/* Colors for the progress bar based on quality */
.progress-bar-fill.good { background-color: #28a745; }
.progress-bar-fill.average { background-color: #ffc107; }
.progress-bar-fill.poor { background-color: #dc3545; }
.progress-bar-fill.bad { background-color: #343a40; }

.prediction-breakdown {
    margin-top: 10px;
    font-size: 0.8em;
    color: #888;
    width: 100%;
    text-align: left;
}

/* Dynamic colors for the quality text. */
#water_quality.water-quality-good { color: #28a745; }
#water_quality.water-quality-average { color: #ffc107; }
#water_quality.water-quality-poor { color: #dc3545; }
#water_quality.water-quality-bad { color: #6c757d; }

/* --- ML ACTIVE BORDER ANIMATION --- */

/* Keyframes for the sliding gradient effect */
@keyframes sliding-gradient-border {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

/* The main class that activates the animation */
.gauge-container-wrapper .card.ml-active-border {
    --border-thickness: 4px;
    position: relative;
    border: var(--border-thickness) solid transparent;
    border-radius: 15px; /* Match the card's border-radius */
    
    /* --- THIS IS THE CORRECTED PART --- */
    /* Define the two background layers here: the solid content background 
       and the animated gradient for the border. */
    background-image:
        /* Layer 1 (Top): The solid white background for the content. */
        linear-gradient(to right, #ffffff, #ffffff),
        /* Layer 2 (Bottom): The animated violet and blue gradient for the border. */
        linear-gradient(90deg, #8a2be2, #007bff, #4682b4, #007bff, #8a2be2);
    
    background-clip: padding-box, border-box;
    background-origin: border-box;
    background-size: 200% 100%;
    animation: sliding-gradient-border 4s ease-in-out infinite;
}

/* --- LLM ANALYSIS BUTTON --- */
/* Styles for the "Generate AI Analysis" button on the dashboard. */

/* Wrapper to position the button.
   Applied to: <div class="llm-button-wrapper"> */
.llm-button-wrapper {
    position: sticky;
    bottom: 0;
    display: flex;
    justify-content: flex-start;
    z-index: 1;
    float: left;
}

/* General style for the AI buttons.
   Applied to: <button class="llm-button"> */
.llm-button {
    background-color: #007bff;
    color: white;
    padding: 12px 25px;
    border: none;
    border-radius: 30px;
    cursor: pointer;
    font-size: 1.1em;
    font-weight: 600;
    margin-top: 15px;
    transition: background-color 0.3s ease;
    display: block;
    margin-left: auto;
    margin-right: auto;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    z-index: 1;
}

.llm-button:hover {
    background-color: #0056b3;
}

/* Style for the "Return to Static" button.
   Applied to: <button id="returnStaticBtn"> */
#returnStaticBtn {
    background-color: #6c757d;
}

#returnStaticBtn:hover {
    background-color: #495057;
}

/* Glowing/animated style for the main "Generate AI Analysis" button.
   Applied to: <button id="getLlmAnalysisBtn"> */
#getLlmAnalysisBtn {
    background: linear-gradient(45deg, #007bff, #8a2be2);
    position: relative;
    z-index: 1;
    box-shadow: 0 0 10px rgba(136, 58, 255, 0.6), 0 0 20px rgba(255, 0, 144, 0.4);
    animation: glowPulse 1.8s ease-in-out infinite;
    overflow: hidden;
}

/* Psuedo-element for the animated border effect. */
#getLlmAnalysisBtn::before {
    content: "";
    position: absolute;
    top: -15px;
    left: -15px;
    right: 15px;
    bottom: -15px;
    border-radius: 35px;
    z-index: -1;
    filter: blur(8px);
    opacity: 0.7;
    animation: borderShine 5s linear infinite;
}


/* --- Loading Spinner Animation --- */
/* A simple spinner used when waiting for AI analysis.
   Applied to: <div class="loader"> */
.loader {
    border: 5px solid #f3f3f3; /* Light grey */
    border-top: 5px solid #3498db; /* Blue */
    border-radius: 50%;
    width: 40px;
    height: 40px;
    animation: spin 1s linear infinite;
    margin: 20px auto; /* Centers the spinner */
}

/* --- AI (LLM) ANALYSIS OUTPUT STYLES --- */

/* Keyframes for a smooth, sliding gradient effect for the border */
@keyframes sliding-gradient-border {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

/* Styles for the section displaying the parameters used for the AI analysis */
.llm-parameters {
    background-color: #f8f9fa;
    border: 1px solid #e9ecef;
    border-radius: 10px;
    padding: 15px;
    margin-top: 15px;
    margin-bottom: 25px;
}
.llm-parameters h3 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 1.2em;
    color: #495057;
}
.llm-parameters p {
    margin: 5px 0;
    font-size: 1.5em;
}

/* The main container for each AI output section */
.llm-output-section {
    --border-thickness: 4px;
    position: relative;
    padding: 20px;
    margin-top: 25px;
    border-radius: 12px;
    font-size: 1.3em;

    /* 1. The border itself is made transparent. The gradient will show through here. */
    border: var(--border-thickness) solid transparent;

    /* 2. We define two separate background layers, in order from top to bottom. */
    background-image:
        /* Layer 1 (Top): The solid white background for the content. */
        linear-gradient(to right, #ffffff, #ffffff),
        /* Layer 2 (Bottom): The animated gradient for the border. */
        linear-gradient(90deg, #8a2be2, #007bff, #4682b4, #007bff, #8a2be2);
    
    /* 3. This is the key: We clip each background layer to a different box. */
    background-clip:
        /* The white background is clipped to the padding-box (inside the border). */
        padding-box,
        /* The gradient background is clipped to the border-box (the outermost edge). */
        border-box;

    /* 4. Both backgrounds should originate from the same outer edge. */
    background-origin: border-box;

    /* Make the gradient twice as wide for a smooth sliding animation */
    background-size: 200% 100%;

    /* Apply the animation to the background's position */
    animation: sliding-gradient-border 4s ease-in-out infinite;
}

/* Styles for the title of each output section */
.llm-output-section h3 {
    margin-top: 0;
    margin-bottom: 10px;
    color: #333;
    border-bottom: 1px solid #eee;
    padding-bottom: 8px;
    font-size: 1.5em;
}

/* Styles for the div that holds the AI-generated text */
.llm-output-section > div {
    color: #555;
    line-height: 1.6;
}

/* (The styles for .llm-parameters, .llm-output-section h3, etc., remain the same) */

/* The rotation animation for the spinner. */
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* The pulsing glow animation for the AI button. */
@keyframes glowPulse {
    0%, 100% { box-shadow: 0 0 10px rgba(136, 58, 255, 0.6), 0 0 20px rgba(255, 0, 144, 0.4); }
    50% { box-shadow: 0 0 15px rgba(255, 0, 255, 0.9), 0 0 30px rgba(30, 144, 255, 0.6); }
}

/* The shining border animation for the AI button. */
@keyframes borderShine {
    0% { background-position: 0% 50%; }
    100% { background-position: 200% 50%; }
}


/* --- RESPONSIVE STYLES FOR DASHBOARD --- */

/* For screens smaller than 1400px (tablets and small desktops). */
@media (max-width: 1400px) {
    .main-content {
        margin-left: 0 !important;
        padding-left: 15px;
        padding-right: 15px;
        width: 100%;
        box-sizing: border-box;
    }
    .top-layout {
        gap: 20px;
        justify-content: center;
        flex-wrap: wrap;
    }
    .quality-explanation,
    #chartsContainer {
        width: 100% !important;
        max-width: 95% !important;
        margin: 0 auto;
    }
    .quality-explanation {
        display: flex;
        flex-direction: column;
        height: 640px;
        overflow-y: auto;
    }
    #chartsContainer {
        display: grid !important;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
    }
    #chartsContainer canvas {
        max-width: 100% !important;
        width: 100% !important;
        height: auto !important;
    }
    /* Repositions gauges to a fixed bar at the bottom. */
    .gauge-container-wrapper {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        gap: 15px;
        padding: 20px;
        z-index: 1000;
        margin: 0;
        border-radius: 0;
        align-items: center;
        justify-items: center;
        background: linear-gradient(to top, rgba(0, 0, 0, 0.9), transparent);
    }
    .gauge-container-wrapper .card {
        grid-column: span 2;
        width: 100%;
        height: 100%;
    }
    .llm-button-wrapper {
        display: flex;
        justify-content: center;
        margin-top: auto;
    }
    #water_quality {
        text-align: center;
        width: 100%;
    }
}

/* For screens smaller than 992px (mobile and tablets). */
@media (max-width: 992px) {
    .top-layout {
        flex-direction: column;
        align-items: center;
        gap: 20px;
        margin-bottom: 32vh; /* Adds space at the bottom for the fixed gauge bar. */
    }
    .quality-explanation {
        width: 95% !important;
        max-width: 600px;
        padding: 15px;
        font-size: 0.95em;
        display: flex;
        flex-direction: column;
        max-height: 100%;
        height: 100%;
        overflow-y: hidden;
    }
    #chartsContainer {
        max-width: 95%;
        grid-template-columns: 1fr !important; /* Stacks charts in a single column. */
        gap: 15px;
        margin: 0;
    }
    #chartsContainer canvas {
        max-width: 100%;
        height: auto;
        margin: 0;
    }
    .gauge-container-wrapper {
        grid-template-columns: repeat(4, 1fr);
        width: 100%;
    }

    .gauge-container-wrapper .card {
        grid-column: 1 / -1;
        flex-direction: row;
        align-items: center;
        justify-content: space-around;
        gap: 15px;
        width: 100%;
        padding: 10px 20px; 
        border-radius: 15px;
    }

    /* Style for the new wrapper around the quality text */
    .quality-display {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        flex-shrink: 0; 
        min-width: 30vw;
    }

    /* Adjust the confidence container to fit in the row */
    #mlConfidenceContainer {
        margin-top: 0;
        width: 100%;
    }

    .gauge-card {
        border-radius: 15px;
        min-width: unset;
        width: 100%;
        padding: 5px;
    }
    .gauge-card .gauge {
        width: 100%;
        height: 60px;
    }
    .card .label {
        font-size: 1em;
    }
    .gauge-label {
        font-size: .7em;
    }
    #water_quality {
        font-size: 1.5em;
    }
}

/* For screens smaller than 576px (small mobile). */
@media (max-width: 576px) {
    .quality-explanation {
        font-size: 0.7em;
        padding: 10px;
    }
    .quality-explanation h2, .quality-explanation h3 {
        font-size: 1.2em;
    }
    #chartsContainer {
        grid-template-columns: 1fr;
        gap: 10px;
    }
    .gauge-container-wrapper {
        grid-template-columns: repeat(4, 1fr);
        gap: 10px;
        padding: 5px;
    }
    .gauge-container-wrapper .card {
        grid-column: span 4;
        width: 100%;
        height: 80%;
        border-radius: 15px;
    }
    .gauge-card {
        border-radius: 20%;
    }
    .card .label {
        font-size: .7em;
    }
    .gauge-label {
        font-size: .4em;
    }
    #water_quality {
        font-size: 1.7em;
    }
}
